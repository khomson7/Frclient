"use strict";var __awaiter=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(r,t){function n(e){try{o(c.next(e))}catch(e){t(e)}}function i(e){try{o(c.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,i)}o((c=c.apply(e,a||[])).next())})},__generator=this&&this.__generator||function(r,n){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(exports,"__esModule",{value:!0});var drug_1=require("../models/drug");function drugCon(r){return __awaiter(this,void 0,void 0,function(){var oe,ae,t=this;return __generator(this,function(e){return oe=new drug_1.DrugModel,ae=r.db3,r.get("/drug/:date",{preValidation:[r.authenticate]},function(n,i){return __awaiter(t,void 0,void 0,function(){var t,r;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=n.params,t=t.date,[4,oe.SearcDrug(ae,t)];case 1:return r=e.sent(),i.send({ok:!0,data:r}),[3,3];case 2:return r=e.sent(),console.log(r),i.code(500).send({ok:!1,error:r}),process.exit(0),[3,3];case 3:return[2]}})})}),r.post("/drugitems",{preValidation:[r.authenticate]},function(ne,ie){return __awaiter(t,void 0,void 0,function(){var t,r,n,i,o,a,s,c,u,d,l,p,_,h,g,m,f,y,v,k,b,w,x,q,S,V,C,D,M,P,j,E,G,O,T,z,A,B,F,H,I,J,K,L,N,Q,R,U,W,X,Y,Z,$,ee,te,re;return __generator(this,function(e){switch(e.label){case 0:te=ne.body,t=te.icode,r=te.name,n=te.strength,i=te.units,o=te.unitprice,a=te.dosageform,s=te.drugaccount,c=te.drugcategory,u=te.drugnote,d=te.hintcode,l=te.istatus,p=te.lastupdatestdprice,_=te.lockprice,h=te.lockprint,g=te.maxlevel,m=te.minlevel,f=te.maxunitperdose,y=te.packqty,v=te.stdprice,k=te.therapeutic,b=te.therapeuticgroup,w=te.default_qty,x=te.gpo_code,q=te.use_right,S=te.drugusage,V=te.high_cost,C=te.must_paid,D=te.alert_level,M=te.access_level,P=te.sticker_short_name,j=te.paidst,E=te.antibiotic,G=te.displaycolor,O=te.empty,T=te.empty_text,z=te.unitcost,A=te.gfmiscode,B=te.ipd_price,F=te.habit_forming,H=te.did,I=te.stock_type,J=te.price2,K=te.price3,L=te.ipd_price2,N=te.ipd_price3,Q=te.price_lock,R=te.generic_name,U=te.income,W=te.print_sticker_pq,X=te.no_discount,Y=te.print_sticker_header,Z=te.item_in_hospital,$=te.no_substock,ee=te.last_update,te=te.check_,e.label=1;case 1:return e.trys.push([1,3,,4]),(re={}).icode=t,re.name=r,re.strength=n,re.units=i,re.unitprice=o,re.dosageform=a,re.drugaccount=s,re.drugcategory=c,re.drugnote=u,re.hintcode=d,re.istatus=l,re.lastupdatestdprice=p,re.lockprice=_,re.lockprint=h,re.maxlevel=g,re.minlevel=m,re.maxunitperdose=f,re.packqty=y,re.stdprice=v,re.therapeutic=k,re.therapeuticgroup=b,re.default_qty=w,re.gpo_code=x,re.use_right=q,re.drugusage=S,re.high_cost=V,re.must_paid=C,re.alert_level=D,re.access_level=M,re.sticker_short_name=P,re.paidst=j,re.antibiotic=E,re.displaycolor=G,re.empty=O,re.empty_text=T,re.unitcost=z,re.gfmiscode=A,re.ipd_price=B,re.habit_forming=F,re.did=H,re.stock_type=I,re.price2=J,re.price3=K,re.ipd_price2=L,re.ipd_price3=N,re.price_lock=Q,re.generic_name=R,re.income=U,re.print_sticker_pq=W,re.no_discount=X,re.print_sticker_header=Y,re.item_in_hospital=Z,re.no_substock=$,re.last_update=ee,re.check_=te,[4,oe.create(ae,re)];case 2:return e.sent(),ie.send({ok:!0}),[3,4];case 3:return re=e.sent(),console.log(re),ie.code(500).send({ok:!1,message:re}),[3,4];case 4:return[2]}})})}),r.delete("/drugitems",{preValidation:[r.authenticate]},function(r,n){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),r.params,[4,oe.remove(ae)];case 1:return e.sent(),n.send({ok:!0}),[3,3];case 2:return t=e.sent(),console.log(t),n.code(500).send({ok:!1,error:t}),[3,3];case 3:return[2]}})})}),r.post("/sdrugitems",{preValidation:[r.authenticate]},function(V,C){return __awaiter(t,void 0,void 0,function(){var t,r,n,i,o,a,s,c,u,d,l,p,_,h,g,m,f,y,v,k,b,w,x,q,S;return __generator(this,function(e){switch(e.label){case 0:q=V.body,t=q.icode,r=q.name,n=q.strength,i=q.units,o=q.dosageform,a=q.drugnote,s=q.use_right,c=q.must_paid,u=q.istatus,d=q.access_level,l=q.paidst,p=q.displaycolor,_=q.price_lock,h=q.ename,g=q.cost,m=q.income,f=q.is_medication,y=q.is_medsupply,v=q.highcost,k=q.billcode,b=q.nhso_adp_type_id,w=q.nhso_adp_code,x=q.unitprice,q=q.drugaccount,e.label=1;case 1:return e.trys.push([1,3,,4]),(S={}).icode=t,S.name=r,S.strength=n,S.units=i,S.dosageform=o,S.drugnote=a,S.use_right=s,S.must_paid=c,S.istatus=u,S.access_level=d,S.paidst=l,S.displaycolor=p,S.price_lock=_,S.ename=h,S.cost=g,S.income=m,S.is_medication=f,S.is_medsupply=y,S.highcost=v,S.billcode=k,S.nhso_adp_type_id=b,S.nhso_adp_code=w,S.unitprice=x,S.drugaccount=q,[4,oe.createSdrug(ae,S)];case 2:return e.sent(),C.send({ok:!0}),[3,4];case 3:return S=e.sent(),console.log(S),C.code(500).send({ok:!1,message:S}),[3,4];case 4:return[2]}})})}),r.delete("/sdrugitems",{preValidation:[r.authenticate]},function(r,n){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),r.params,[4,oe.removeSdrug(ae)];case 1:return e.sent(),n.send({ok:!0}),[3,3];case 2:return t=e.sent(),console.log(t),n.code(500).send({ok:!1,error:t}),[3,3];case 3:return[2]}})})}),[2]})})}exports.default=drugCon;