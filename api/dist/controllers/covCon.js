"use strict";var __awaiter=this&&this.__awaiter||function(e,c,i,s){return new(i=i||Promise)(function(r,t){function n(e){try{o(s.next(e))}catch(e){t(e)}}function a(e){try{o(s.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(n,a)}o((s=s.apply(e,c||[])).next())})},__generator=this&&this.__generator||function(r,n){var a,o,c,i={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,o&&(c=2&t[0]?o.return:t[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,t[1])).done)return c;switch(o=0,(t=c?[2&t[0],c.value]:t)[0]){case 0:case 1:c=t;break;case 4:return i.label++,{value:t[1],done:!1};case 5:i.label++,o=t[1],t=[0];continue;case 7:t=i.ops.pop(),i.trys.pop();continue;default:if(!(c=0<(c=i.trys).length&&c[c.length-1])&&(6===t[0]||2===t[0])){i=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){i.label=t[1];break}if(6===t[0]&&i.label<c[1]){i.label=c[1],c=t;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(t);break}c[2]&&i.ops.pop(),i.trys.pop();continue}t=n.call(r,i)}catch(e){t=[6,e],o=0}finally{a=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(exports,"__esModule",{value:!0});var cov_1=require("../models/cov");function covCon(r){return __awaiter(this,void 0,void 0,function(){var H,I,n,t=this;return __generator(this,function(e){return H=new cov_1.CovModel,I=r.db3,n=r.db4,r.post("/",{preValidation:[r.authenticate]},function(D,F){return __awaiter(t,void 0,void 0,function(){var t,r,n,a,o,c,i,s,u,l,_,d,h,p,f,v,m,y,g,w,b,k,x,C,q,S,M,P,V,j,E,G,O,T,z,A,B;return __generator(this,function(e){switch(e.label){case 0:A=D.body,t=A.timestamp,r=A.selection,n=A.depart,a=A.pttyename,o=A.atk_date,c=A.si_date,i=A.pname,s=A.fname,u=A.age_y,l=A.cid,_=A.tel,d=A.bw,h=A.ht,p=A.clinic,f=A.cc,v=A.prakan_covid,m=A.send_xray,y=A.normal_drug,g=A.req_certificate,w=A.dch_date,b=A.prov_at48,k=A.wish_hos,x=A.progress_note48,C=A.management48,q=A.progress_note_last48,S=A.management_last48,M=A.doctor,P=A.chwpart,V=A.amppart,j=A.tmbpart,E=A.moopart,G=A.hicikey,O=A.atk_date_thai,T=A.si_date_thai,z=A.doctor_fullname,A=A.liceneno,e.label=1;case 1:return e.trys.push([1,3,,4]),(B={}).timestamp=t,B.selection=r,B.depart=n,B.pttyename=a,B.atk_date=o,B.si_date=c,B.pname=i,B.fname=s,B.age_y=u,B.cid=l,B.tel=_,B.bw=d,B.ht=h,B.clinic=p,B.cc=f,B.prakan_covid=v,B.send_xray=m,B.normal_drug=y,B.req_certificate=g,B.dch_date=w,B.prov_at48=b,B.wish_hos=k,B.progress_note48=x,B.management48=C,B.progress_note_last48=q,B.management_last48=S,B.doctor=M,B.chwpart=P,B.amppart=V,B.tmbpart=j,B.moopart=E,B.hicikey=G,B.atk_date_thai=O,B.si_date_thai=T,B.doctor_fullname=z,B.liceneno=A,[4,H.create(I,B)];case 2:return e.sent(),F.send({ok:!0}),[3,4];case 3:return B=e.sent(),console.log(B),F.code(500).send({ok:!1,message:B}),[3,4];case 4:return[2]}})})}),r.delete("/:hicikey",{preValidation:[r.authenticate]},function(r,n){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=r.params,t=t.hicikey,[4,H.remove(I,t)];case 1:return e.sent(),n.send({ok:!0}),[3,3];case 2:return t=e.sent(),console.log(t),n.code(500).send({ok:!1,error:t}),[3,3];case 3:return[2]}})})}),r.get("/covac",{},function(e,r){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,H.searchCovac(n)];case 1:return t=e.sent(),r.send(t),[3,3];case 2:return t=e.sent(),console.log(t),r.code(500).send({ok:!1,error:t}),process.exit(0),[3,3];case 3:return[2]}})})}),r.get("/chksend",{},function(e,r){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,H.ChkSend(n)];case 1:return e.sent(),r.send("success"),[3,3];case 2:return t=e.sent(),console.log(t),r.code(500).send({ok:!1,error:t}),process.exit(0),[3,3];case 3:return[2]}})})}),[2]})})}exports.default=covCon;